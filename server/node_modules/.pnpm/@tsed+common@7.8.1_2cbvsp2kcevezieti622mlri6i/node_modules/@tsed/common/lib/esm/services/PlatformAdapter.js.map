{"version":3,"file":"PlatformAdapter.js","sourceRoot":"","sources":["../../../src/services/PlatformAdapter.ts"],"names":[],"mappings":"AACA,OAAO,EAAC,eAAe,EAAgB,gBAAgB,EAAC,MAAM,UAAU,CAAC;AAKzE,OAAO,EAAC,WAAW,EAAC,MAAM,eAAe,CAAC;AAE1C,MAAM,OAAgB,eAAe;IACnC;;OAEG;IACH,SAAS,CAAiB;IAC1B;;OAEG;IACH,MAAM,CAAa;IACnB,gBAAgB,CAAsB;IACtC,eAAe,CAAsB;CAsCtC;AAMD,gBAAgB,CAAC;IACf,OAAO,EAAE,eAAe;IACxB,IAAI,EAAE,CAAC,eAAe,CAAC;IACvB,QAAQ,EAAE,WAAW;CACtB,CAAC,CAAC","sourcesContent":["import {Type} from \"@tsed/core\";\nimport {InjectorService, ProviderOpts, registerProvider} from \"@tsed/di\";\nimport {PlatformHandlerMetadata, PlatformLayer} from \"@tsed/platform-router\";\nimport {IncomingMessage, ServerResponse} from \"http\";\nimport {PlatformMulter, PlatformMulterSettings} from \"../config/interfaces/PlatformMulterSettings\";\nimport {PlatformStaticsOptions} from \"../config/interfaces/PlatformStaticsSettings\";\nimport {FakeAdapter} from \"./FakeAdapter\";\n\nexport abstract class PlatformAdapter<App = TsED.Application> {\n  /**\n   * Load providers in top priority\n   */\n  providers: ProviderOpts[];\n  /**\n   * Called after the injector instantiation\n   */\n  onInit?: () => any;\n  beforeLoadRoutes?: () => Promise<any>;\n  afterLoadRoutes?: () => Promise<any>;\n  /**\n   * create initial context\n   */\n  abstract useContext: () => any;\n  /**\n   * Map router layer to the targeted framework\n   */\n  abstract mapLayers: (layer: PlatformLayer[]) => void;\n  /**\n   * Map handler to the targeted framework\n   */\n  abstract mapHandler: (handler: Function, layer: PlatformHandlerMetadata) => Function;\n\n  /**\n   * Return the app instance\n   */\n  abstract app(): {app: App; callback(): (req: IncomingMessage, res: ServerResponse) => void};\n\n  /**\n   * Return the statics middlewares\n   * @param endpoint\n   * @param options\n   */\n  abstract statics(endpoint: string, options: PlatformStaticsOptions): any;\n\n  /**\n   * Return the multipart middleware\n   * @param options\n   */\n  abstract multipart(options: PlatformMulterSettings): PlatformMulter;\n\n  /**\n   * Return the body parser for the given\n   * @param type\n   * @param opts\n   */\n  abstract bodyParser(type: string, opts?: Record<string, any>): any;\n}\n\nexport interface PlatformBuilderSettings<App = TsED.Application> extends Partial<TsED.Configuration> {\n  adapter?: Type<PlatformAdapter<App>>;\n}\n\nregisterProvider({\n  provide: PlatformAdapter,\n  deps: [InjectorService],\n  useClass: FakeAdapter\n});\n"]}